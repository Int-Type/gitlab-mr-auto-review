spring.application.name=codereview

############################################
# ?? ??
############################################
server.port=${PORT:8080}
server.servlet.context-path=${CONTEXT_PATH:/}

# ??? ??
spring.jackson.time-zone=Asia/Seoul

############################################
# GitLab ??
############################################
app.gitlab.url=${GITLAB_URL}
app.gitlab.token=${GITLAB_TOKEN}
app.gitlab.webhook-secret=${GITLAB_WEBHOOK_SECRET}
app.gitlab.allowed-projects=${GITLAB_ALLOWED_PROJECTS:}

############################################
# LLM ?? ?? (?? LLM ??)
############################################
# ?? ?? - ? ??? ????? ?????
app.llm.api-key=${LLM_API_KEY:}
app.llm.model=${LLM_MODEL:}
app.llm.system-prompt=${LLM_SYSTEM_PROMPT:}

# OpenAI ?? ??
app.llm.openai.api-url=https://api.openai.com/v1
app.llm.openai.api-key=${LLM_OPENAI_API_KEY:}
app.llm.openai.model=gpt-4o-mini

# Claude ?? ??
app.llm.claude.api-url=https://api.anthropic.com/v1
app.llm.claude.api-key=${LLM_CLAUDE_API_KEY:}
app.llm.claude.model=claude-sonnet-4-20250514

# Gemini ?? ??
app.llm.gemini.api-url=https://generativelanguage.googleapis.com/v1beta
app.llm.gemini.api-key=${LLM_GEMINI_API_KEY:}
app.llm.gemini.model=gemini-2.5-pro

############################################
# ?? ??
############################################
logging.level.com.inttype.codereview=${APP_LOG_LEVEL:INFO}
logging.level.org.gitlab4j=${GITLAB4J_LOG_LEVEL:INFO}
logging.level.org.springframework.web=${SPRING_WEB_LOG_LEVEL:INFO}

############################################
# Actuator (????)
############################################
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when_authorized

############################################
# ??? ??? (??? ? ??)
############################################
spring.task.execution.pool.core-size=4
spring.task.execution.pool.max-size=8
spring.task.execution.pool.queue-capacity=100
spring.task.execution.thread-name-prefix=mr-review-

############################################
# Resilience4j (Retry / CircuitBreaker)
############################################

# CircuitBreaker: gitlab
resilience4j.circuitbreaker.instances.gitlab.sliding-window-type=COUNT_BASED
resilience4j.circuitbreaker.instances.gitlab.sliding-window-size=20
resilience4j.circuitbreaker.instances.gitlab.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.gitlab.wait-duration-in-open-state=10s
resilience4j.circuitbreaker.instances.gitlab.permitted-number-of-calls-in-half-open-state=5
resilience4j.circuitbreaker.instances.gitlab.minimum-number-of-calls=10

# Retry: gitlab
resilience4j.retry.instances.gitlab.max-attempts=3
resilience4j.retry.instances.gitlab.wait-duration=500ms
resilience4j.retry.instances.gitlab.retry-exceptions=org.gitlab4j.api.GitLabApiException,java.io.IOException

# Retry: chatgpt (?? ??? - Deprecated)
resilience4j.retry.instances.chatgpt.max-attempts=3
resilience4j.retry.instances.chatgpt.wait-duration=500ms
resilience4j.retry.instances.chatgpt.retry-exceptions=java.io.IOException,org.springframework.web.reactive.function.client.WebClientResponseException

# Retry: openai
resilience4j.retry.instances.openai.max-attempts=3
resilience4j.retry.instances.openai.wait-duration=500ms
resilience4j.retry.instances.openai.retry-exceptions=java.io.IOException,org.springframework.web.reactive.function.client.WebClientResponseException

# Retry: claude
resilience4j.retry.instances.claude.max-attempts=3
resilience4j.retry.instances.claude.wait-duration=500ms
resilience4j.retry.instances.claude.retry-exceptions=java.io.IOException,org.springframework.web.reactive.function.client.WebClientResponseException

# Retry: gemini
resilience4j.retry.instances.gemini.max-attempts=3
resilience4j.retry.instances.gemini.wait-duration=500ms
resilience4j.retry.instances.gemini.retry-exceptions=java.io.IOException,org.springframework.web.reactive.function.client.WebClientResponseException

# Retry: llm (?? fallback ??)
resilience4j.retry.instances.llm.max-attempts=3
resilience4j.retry.instances.llm.wait-duration=500ms
resilience4j.retry.instances.llm.retry-exceptions=java.io.IOException,org.springframework.web.reactive.function.client.WebClientResponseException
