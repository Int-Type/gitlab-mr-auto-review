spring.application.name=codereview

############################################
# ?? ??
############################################
server.port=${PORT}
server.servlet.context-path=${CONTEXT_PATH}

# ??? ??
spring.jackson.time-zone=Asia/Seoul

############################################
# GitLab ??
############################################
app.gitlab.url=${GITLAB_URL}
app.gitlab.token=${GITLAB_TOKEN}
app.gitlab.webhook-secret=${GITLAB_WEBHOOK_SECRET}
app.gitlab.allowed-projects=${GITLAB_ALLOWED_PROJECTS}

############################################
# ChatGPT ?? (?? ??? ??)
############################################
app.chatgpt.api-url=${CHATGPT_API_URL}
app.chatgpt.api-key=${CHATGPT_API_KEY}
app.chatgpt.model=${CHATGPT_MODEL}
app.chatgpt.system-prompt=${CHATGPT_SYSTEM_PROMPT}

############################################
# LLM ?? ?? (?? LLM ??)
############################################
# ?? ??
app.llm.api-url=${LLM_API_URL}
app.llm.api-key=${LLM_API_KEY}
app.llm.model=${LLM_MODEL}
app.llm.system-prompt=${LLM_SYSTEM_PROMPT}
app.llm.openai-compatible=${LLM_OPENAI_COMPATIBLE}

# OpenAI ??
app.llm.openai.api-url=${LLM_OPENAI_API_URL}
app.llm.openai.api-key=${LLM_OPENAI_API_KEY}
app.llm.openai.model=${LLM_OPENAI_MODEL}

# Claude ??
app.llm.claude.api-url=${LLM_CLAUDE_API_URL}
app.llm.claude.api-key=${LLM_CLAUDE_API_KEY}
app.llm.claude.model=${LLM_CLAUDE_MODEL}

# Gemini ??
app.llm.gemini.api-url=${LLM_GEMINI_API_URL}
app.llm.gemini.api-key=${LLM_GEMINI_API_KEY}
app.llm.gemini.model=${LLM_GEMINI_MODEL}

############################################
# ?? ??
############################################
logging.level.com.inttype.codereview=${APP_LOG_LEVEL}
logging.level.org.gitlab4j=${GITLAB4J_LOG_LEVEL}
logging.level.org.springframework.web=${SPRING_WEB_LOG_LEVEL}

############################################
# Actuator (????)
############################################
management.endpoints.web.exposure.include=${ACTUATOR_EXPOSE}
management.endpoint.health.show-details=${ACTUATOR_HEALTH_DETAILS}

############################################
# ??? ??? (??? ? ??)
############################################
spring.task.execution.pool.core-size=${EXECUTOR_CORE_SIZE}
spring.task.execution.pool.max-size=${EXECUTOR_MAX_SIZE}
spring.task.execution.pool.queue-capacity=${EXECUTOR_QUEUE_CAPACITY}
spring.task.execution.thread-name-prefix=${EXECUTOR_PREFIX}

############################################
# Resilience4j (Retry / CircuitBreaker)
############################################

# CircuitBreaker: gitlab
resilience4j.circuitbreaker.instances.gitlab.sliding-window-type=${CB_WINDOW_TYPE}
resilience4j.circuitbreaker.instances.gitlab.sliding-window-size=${CB_WINDOW_SIZE}
resilience4j.circuitbreaker.instances.gitlab.failure-rate-threshold=${CB_FAILURE_RATE}
resilience4j.circuitbreaker.instances.gitlab.wait-duration-in-open-state=${CB_OPEN_WAIT}
resilience4j.circuitbreaker.instances.gitlab.permitted-number-of-calls-in-half-open-state=${CB_HALF_OPEN_CALLS}
resilience4j.circuitbreaker.instances.gitlab.minimum-number-of-calls=${CB_MIN_CALLS}

# Retry: gitlab
resilience4j.retry.instances.gitlab.max-attempts=${RETRY_MAX_ATTEMPTS}
resilience4j.retry.instances.gitlab.wait-duration=${RETRY_WAIT}
resilience4j.retry.instances.gitlab.retry-exceptions=org.gitlab4j.api.GitLabApiException,java.io.IOException

# Retry: chatgpt (?? ???)
resilience4j.retry.instances.chatgpt.max-attempts=${CHATGPT_RETRY_MAX_ATTEMPTS}
resilience4j.retry.instances.chatgpt.wait-duration=${CHATGPT_RETRY_WAIT}
resilience4j.retry.instances.chatgpt.retry-exceptions=java.io.IOException,org.springframework.web.reactive.function.client.WebClientResponseException

# Retry: openai
resilience4j.retry.instances.openai.max-attempts=${LLM_OPENAI_RETRY_MAX_ATTEMPTS}
resilience4j.retry.instances.openai.wait-duration=${LLM_OPENAI_RETRY_WAIT}
resilience4j.retry.instances.openai.retry-exceptions=java.io.IOException,org.springframework.web.reactive.function.client.WebClientResponseException

# Retry: claude
resilience4j.retry.instances.claude.max-attempts=${LLM_CLAUDE_RETRY_MAX_ATTEMPTS}
resilience4j.retry.instances.claude.wait-duration=${LLM_CLAUDE_RETRY_WAIT}
resilience4j.retry.instances.claude.retry-exceptions=java.io.IOException,org.springframework.web.reactive.function.client.WebClientResponseException

# Retry: gemini
resilience4j.retry.instances.gemini.max-attempts=${LLM_GEMINI_RETRY_MAX_ATTEMPTS}
resilience4j.retry.instances.gemini.wait-duration=${LLM_GEMINI_RETRY_WAIT}
resilience4j.retry.instances.gemini.retry-exceptions=java.io.IOException,org.springframework.web.reactive.function.client.WebClientResponseException

# Retry: llm (generic fallback)
resilience4j.retry.instances.llm.max-attempts=${LLM_RETRY_MAX_ATTEMPTS}
resilience4j.retry.instances.llm.wait-duration=${LLM_RETRY_WAIT}
resilience4j.retry.instances.llm.retry-exceptions=java.io.IOException,org.springframework.web.reactive.function.client.WebClientResponseException
